-- ==========================================
-- Hotel Management Database Tables
-- SQL Server Script
-- ==========================================

-- 1. Hotel
CREATE TABLE Hotel (
    hotel_id INT IDENTITY(1,1) PRIMARY KEY,
    name NVARCHAR(100) NOT NULL,
    address NVARCHAR(200),
    star_rating TINYINT,
    phone NVARCHAR(20)
);

-- 2. RoomType
CREATE TABLE RoomType (
    room_type_id INT IDENTITY(1,1) PRIMARY KEY,
    type_name NVARCHAR(50) NOT NULL,
    capacity TINYINT NOT NULL,
    amenities NVARCHAR(MAX)
);

-- 3. Room
CREATE TABLE Room (
    room_id INT IDENTITY(1,1) PRIMARY KEY,
    hotel_id INT NOT NULL,
    room_number NVARCHAR(10) NOT NULL,
    room_type_id INT NOT NULL,
    floor TINYINT,
    price_per_night DECIMAL(10,2),
    status NVARCHAR(20),
    CONSTRAINT FK_Room_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id),
    CONSTRAINT FK_Room_RoomType FOREIGN KEY (room_type_id) REFERENCES RoomType(room_type_id)
);

-- 4. Customer
CREATE TABLE Customer (
    customer_id INT IDENTITY(1,1) PRIMARY KEY,
    first_name NVARCHAR(50) NOT NULL,
    last_name NVARCHAR(50) NOT NULL,
    email NVARCHAR(100),
    phone NVARCHAR(20),
    nationality NVARCHAR(50),
    date_of_birth DATE
);

-- 5. Reservation
CREATE TABLE Reservation (
    reservation_id INT IDENTITY(1,1) PRIMARY KEY,
    customer_id INT NOT NULL,
    hotel_id INT NOT NULL,
    reservation_date DATETIME,
    check_in_date DATETIME,
    check_out_date DATETIME,
    status NVARCHAR(20),
    CONSTRAINT FK_Reservation_Customer FOREIGN KEY (customer_id) REFERENCES Customer(customer_id),
    CONSTRAINT FK_Reservation_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id)
);

-- 6. ReservationRoom
CREATE TABLE ReservationRoom (
    reservation_room_id INT IDENTITY(1,1) PRIMARY KEY,
    reservation_id INT NOT NULL,
    room_id INT NOT NULL,
    price DECIMAL(10,2),
    status NVARCHAR(20),
    CONSTRAINT FK_ReservationRoom_Reservation FOREIGN KEY (reservation_id) REFERENCES Reservation(reservation_id),
    CONSTRAINT FK_ReservationRoom_Room FOREIGN KEY (room_id) REFERENCES Room(room_id)
);

-- 7. Payment
CREATE TABLE Payment (
    payment_id INT IDENTITY(1,1) PRIMARY KEY,
    reservation_id INT NOT NULL,
    amount DECIMAL(10,2),
    payment_date DATETIME,
    payment_method NVARCHAR(50),
    status NVARCHAR(20),
    CONSTRAINT FK_Payment_Reservation FOREIGN KEY (reservation_id) REFERENCES Reservation(reservation_id)
);

-- 8. Role
CREATE TABLE Role (
    role_id INT IDENTITY(1,1) PRIMARY KEY,
    role_name NVARCHAR(50) NOT NULL
);

-- 9. Staff
CREATE TABLE Staff (
    staff_id INT IDENTITY(1,1) PRIMARY KEY,
    hotel_id INT NOT NULL,
    role_id INT NOT NULL,
    first_name NVARCHAR(50) NOT NULL,
    last_name NVARCHAR(50) NOT NULL,
    email NVARCHAR(100),
    phone NVARCHAR(20),
    hire_date DATE,
    salary DECIMAL(12,2),
    CONSTRAINT FK_Staff_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id),
    CONSTRAINT FK_Staff_Role FOREIGN KEY (role_id) REFERENCES Role(role_id)
);

-- 10. Service
CREATE TABLE Service (
    service_id INT IDENTITY(1,1) PRIMARY KEY,
    hotel_id INT NOT NULL,
    service_name NVARCHAR(100) NOT NULL,
    description NVARCHAR(MAX),
    price DECIMAL(10,2),
    CONSTRAINT FK_Service_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id)
);

-- 11. ReservationService
CREATE TABLE ReservationService (
    reservation_service_id INT IDENTITY(1,1) PRIMARY KEY,
    reservation_id INT NOT NULL,
    service_id INT NOT NULL,
    quantity INT,
    total_price DECIMAL(10,2),
    CONSTRAINT FK_ReservationService_Reservation FOREIGN KEY (reservation_id) REFERENCES Reservation(reservation_id),
    CONSTRAINT FK_ReservationService_Service FOREIGN KEY (service_id) REFERENCES Service(service_id)
);

-- 12. Invoice
CREATE TABLE Invoice (
    invoice_id INT IDENTITY(1,1) PRIMARY KEY,
    reservation_id INT NOT NULL,
    total_amount DECIMAL(12,2),
    tax DECIMAL(6,2),
    discount DECIMAL(6,2),
    created_date DATETIME,
    status NVARCHAR(20),
    CONSTRAINT FK_Invoice_Reservation FOREIGN KEY (reservation_id) REFERENCES Reservation(reservation_id)
);

-- 13. Housekeeping
CREATE TABLE Housekeeping (
    housekeeping_id INT IDENTITY(1,1) PRIMARY KEY,
    room_id INT NOT NULL,
    staff_id INT NOT NULL,
    date DATETIME,
    status NVARCHAR(20),
    CONSTRAINT FK_Housekeeping_Room FOREIGN KEY (room_id) REFERENCES Room(room_id),
    CONSTRAINT FK_Housekeeping_Staff FOREIGN KEY (staff_id) REFERENCES Staff(staff_id)
);

-- 14. Feedback
CREATE TABLE Feedback (
    feedback_id INT IDENTITY(1,1) PRIMARY KEY,
    customer_id INT NOT NULL,
    hotel_id INT NOT NULL,
    rating TINYINT,
    comment NVARCHAR(MAX),
    date DATETIME,
    CONSTRAINT FK_Feedback_Customer FOREIGN KEY (customer_id) REFERENCES Customer(customer_id),
    CONSTRAINT FK_Feedback_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id)
);

-- 15. Inventory
CREATE TABLE Inventory (
    inventory_id INT IDENTITY(1,1) PRIMARY KEY,
    hotel_id INT NOT NULL,
    item_name NVARCHAR(100) NOT NULL,
    quantity INT,
    unit NVARCHAR(20),
    last_updated DATETIME,
    CONSTRAINT FK_Inventory_Hotel FOREIGN KEY (hotel_id) REFERENCES Hotel(hotel_id)
);
